---
title: "High Performance Computing with R"
author: "David Mawdsley, Pen Richardson, George Leaver"
date: "6 November 2017<p><img src='http://assets.manchester.ac.uk/logos/hi-res/TAB_UNI_MAIN_logo/White_backgrounds/TAB_col_white_background.png' style='border:0px solid black' width='50%'></p>"
output: 
  revealjs::revealjs_presentation:
    transition: fade
    theme: solarize
    fig_height: 6
    self_contained: true
    reveal_options:
      controls: false
---

## Structure

[](Key message - waiting for code to run is a pain.  How do we 
make it quicker?)


* Two parts:
  	* Optimising code (may not _need_ to go down HPC route)
	* HPC at UoM

* HPC facilities at UoM
	* ref George's talk on iCSF
	* Focus on using the CSF; batch jobs

* MS R Open - may not need to go down the HPC route

* Code optimisation
* Assumption - bottleneck is CPU.  Not RAM or IO

## Picture of people getting bored waiting for code to run

##  Optimising code

* Most PCs have 2, 4 or 8 cores.  
  	* R will only use one of these by default
* Two approaches to using more of them:
  	* Explicitly parallise code
	* Use a version of R with libraries that use > 1 core

## Microsoft R Open

* [MS R Open](https://mran.microsoft.com/open/) uses optimised versions of
  [BLAS and LAPACK](https://software.intel.com/en-us/mkl).
  	* Typically quicker even on a single thread
	* Even quicker if we use multiple threads
* Speed up will depend on _what_ you're doing
  	* Linear algebra 

## Show benchmark figures

* Show benchmark figures from https://mran.microsoft.com/documents/rro/multithread/#mt-bench or generate own (compare Windows/Linux)

## Compatibility between standard R and Microsoft R open

* Version lags (slightly) behind standard R
* ["100% compatible with"](https://mran.microsoft.com/open/) standard R
* Uses its own version of [CRAN](https://cran.r-project.org/); MRAN
  	* Frozen snapshot  of CRAN for each release of MS R Open
	* Can install CRAN packages with `repos="URL"` option
	* `checkpoint` library lets you use packages at arbitrary snapshot dates

## Summary slide

* Potentially a really easy win


## The `parallel` package

Benchmark / simple example of this


## The CSF

* [George Leaver talked about the iCSF in March](http://ri.itservices.manchester.ac.uk/course/herc/icsf.pdf)
  	* Interactive facility
* We'll focus on the [CSF](http://ri.itservices.manchester.ac.uk/csf/)
  	* "Traditional" batch system
	* Write a job script, submit it, wait for it to run


